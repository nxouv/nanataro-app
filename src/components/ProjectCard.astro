---
import { getCategoryLabel, getMonthDay } from '../utils/utils.js';

const { title, description, category, date, slug, isFirst = false } = Astro.props;
const label = getCategoryLabel(category);
---

<div class={`timeline-item ${isFirst ? 'is-first' : ''}`} data-category={category}>
  <div class="timeline-header">
    <div class="timeline-dot"></div>
    <div class="timeline-date">{getMonthDay(date)}</div>
  </div>
  <a href={`/projects/${slug}`} class="timeline-card">
    <h3 class="timeline-card-title">{title}</h3>
    <div class="timeline-card-category">{label}</div>
    <p class="timeline-card-description">{description}</p>
  </a>
</div>

<style>
  .timeline-item {
    position: relative;
    margin-bottom: var(--space-7);
  }

  .timeline-item:last-child {
    margin-bottom: 0;
  }

  /* 縦線（ドットの下から次のアイテムまで） */
  .timeline-item::before {
    content: "";
    position: absolute;
    left: -23px;
    top: 0;
    bottom: calc(-1 * var(--space-7));
    width: 1px;
    background: linear-gradient(
      to bottom,
      var(--color-border-strong) 0%,
      var(--color-border) 100%
    );
  }

  /* 最初のアイテムは上部の線を消す */
  .timeline-item.is-first::before {
    top: 11px;
  }

  /* 最後のアイテムは下部の線を消す */
  .timeline-item:last-child::before {
    bottom: 0;
  }

  .timeline-header {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    margin-bottom: var(--space-2);
    margin-left: -28px;
  }

  .timeline-dot {
    width: 11px;
    height: 11px;
    border-radius: var(--radius-full);
    background-color: var(--color-border-strong);
    border: 2px solid var(--color-bg);
    flex-shrink: 0;
    position: relative;
    z-index: 1;
  }

  .timeline-item[data-category="chrome-extension"] .timeline-dot { background-color: var(--color-chrome-extension); }
  .timeline-item[data-category="web-service"] .timeline-dot { background-color: var(--color-web-service); }
  .timeline-item[data-category="desktop-app"] .timeline-dot { background-color: var(--color-desktop-app); }
  .timeline-item[data-category="mobile-app"] .timeline-dot { background-color: var(--color-mobile-app); }
  .timeline-item[data-category="website"] .timeline-dot { background-color: var(--color-website); }

  .timeline-date {
    font-size: var(--text-xs);
    color: var(--color-text-subtle);
    letter-spacing: 0.02em;
  }

  .timeline-card {
    display: block;
    background-color: var(--color-bg-card);
    border-radius: var(--radius-lg);
    padding: 22px var(--space-6);
    transition: transform var(--transition-base), box-shadow var(--transition-base);
    border: 1px solid var(--color-border);
  }

  .timeline-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
  }

  .timeline-card-title {
    font-size: var(--text-lg);
    font-weight: 500;
    color: var(--color-text-primary);
    margin-bottom: var(--space-2);
    line-height: var(--leading-tight);
  }

  .timeline-card-category {
    font-size: var(--text-xs);
    margin-bottom: var(--space-3);
    font-weight: 500;
  }

  .timeline-item[data-category="chrome-extension"] .timeline-card-category { color: var(--color-chrome-extension); }
  .timeline-item[data-category="web-service"] .timeline-card-category { color: var(--color-web-service); }
  .timeline-item[data-category="desktop-app"] .timeline-card-category { color: var(--color-desktop-app); }
  .timeline-item[data-category="mobile-app"] .timeline-card-category { color: var(--color-mobile-app); }
  .timeline-item[data-category="website"] .timeline-card-category { color: var(--color-website); }

  .timeline-card-description {
    font-size: var(--text-base);
    color: var(--color-text-muted);
    line-height: var(--leading-normal);
  }
</style>